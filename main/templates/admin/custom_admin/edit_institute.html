{% extends 'base.html' %}
{% block title %}Edit Institute{% endblock %}
{% load static %}

{% block content %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<link rel="stylesheet" href="{% static 'css/admin/edit_institute.css' %}">

<script src="//cdn.jsdelivr.net/npm/alertifyjs@1.14.0/build/alertify.min.js"></script>
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.14.0/build/css/alertify.min.css"/>

<div class="apply-card mt-5">
  <form id="editForm" method="POST" enctype="multipart/form-data" action="">
    {% csrf_token %}

    <div class="hero">
        {% if institute.background_image %}
            <img id="bgImg" src="{{ institute.background_image.url }}" class="bg-img">
        {% else %}
            <img id="bgImg" src="{% static 'images/bg.png' %}" class="bg-img">
        {% endif %}
        
        <label for="id_background_image" class="bg-camera" title="Change Background">
            <i class="fas fa-camera"></i>
        </label>
        <input type="file" id="id_background_image" name="background_image" accept="image/*" style="display:none">
    </div>


    <div class="logo-circle">
      <div class="logo-inner" id="logoInner">
        {% if institute.profile_logo %}
          <img src="{{ institute.profile_logo.url }}" style="width:100px;height:100px;border-radius:50%;">
        {% else %}
          <i class="fas fa-university"></i>
        {% endif %}
      </div>
      <label for="id_logo_image" class="logo-camera" title="Change Logo">
        <i class="fas fa-camera"></i>
      </label>
      <input type="file" id="id_logo_image" name="profile_logo" accept="image/*" style="display:none">
    </div>

    <!-- Form Fields -->
    <div class="mb-3">
      <label class="form-label">Institute Name</label>
      <input type="text" name="name" class="form-control" value="{{ institute.name }}" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Established Year</label>
      <input type="text" name="estd" class="form-control" value="{{ institute.estd }}">
    </div>

    <div class="mb-3">
      <label class="form-label">Email</label>
      <input type="email" name="email" class="form-control" value="{{ institute.email }}" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Phone</label>
      <input type="text" name="phone" class="form-control" value="{{ institute.phone }}" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Description</label>
      <textarea name="description" rows="3" class="form-control" required>{{ institute.description }}</textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Website</label>
      <input type="url" name="website" class="form-control" value="{{ institute.website }}">
    </div>

    <div class="mb-3">
      <label class="form-label">Address</label>
      <input type="text" name="address" class="form-control" value="{{ institute.address }}" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Registration Number</label>
      <input type="text" name="register_number" class="form-control" value="{{ institute.register_number }}">
    </div>

    <div class="mb-3">
        <div class="mb-3">
        <label class="form-label">Signature</label>
        <input type="file" name="signature" accept="image/*,application/pdf" class="form-control">

        {% if institute.signature %}
            {% if ".pdf" in institute.signature.url|lower %}
                <a href="{{ institute.signature.url }}" target="_blank" class="text-white">View Signature PDF</a>
            {% else %}
                <img src="{{ institute.signature.url }}" style="max-height:110px;">
            {% endif %}
        {% endif %}
    </div>


    <div class="mb-3">
        <label class="form-label">Stamp</label>
        <input type="file" name="stamp" accept="image/*,application/pdf" class="form-control">

        {% if institute.stamp %}
            {% if ".pdf" in institute.stamp.url|lower %}
                <a href="{{ institute.stamp.url }}" target="_blank" class="text-white">View Stamp PDF</a>
            {% else %}
                <img src="{{ institute.stamp.url }}" style="max-height:110px;">
            {% endif %}
        {% endif %}
    </div>




    <div class="mb-3">
      <label class="form-label">Registration Image / PDF</label>
      <input type="file" name="register_image" accept="image/*,application/pdf" class="form-control">
      {% if institute.register_image %}
        {% if ".pdf" in institute.register_image.url|lower %}
        <a href="{{ institute.register_image.url }}" target="_blank" class="text-white">View PDF</a>
        {% else %}
        <img id="regPreviewImg" src="{{ institute.register_image.url }}" class="img-preview" style="max-height:110px;">
        {% endif %}
      {% endif %}
    </div>

    <button class="btn btn-danger btn-lg w-100 mt-3" type="submit">ðŸš€ Save Changes</button>
  </form>
</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="{% static 'js/admin/edit_institute.js' %}"></script>

{% if messages %}
  {% for message in messages %}
    <script>
        alertify.set('notifier','position', 'top-right');
        alertify.success("{{ message }}");
    </script>
  {% endfor %}
{% endif %}

{% endblock %}
